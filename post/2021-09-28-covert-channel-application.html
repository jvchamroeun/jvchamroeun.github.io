<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Covert Channel Application</title>
        <link rel="icon" type="image/x-icon" href="../assets/logo.png" />
        <link rel="stylesheet" href="../css/project.css">
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="../css/styles.css" rel="stylesheet" />
    </head>
    <body>
        <script src="../js/custom-elements/main.js"></script>
        <my-nav-2></my-nav-2>
        <!-- Page Header-->
        <header class="masthead" style="background-image: url('../assets/img/21-covert-channel/banner.jpg')">
            <div class="overlay"></div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-10 mx-auto">
                        <div class="post-heading">
                            <h1 style="font-size:60px; text-shadow: 2px 0 #000, -2px 0 #000, 0 2px #000, 0 -2px #000,
                            1px 1px #000, -1px -1px #000, 1px -1px #000, -1px 1px #000;">Covert Channel Application</h1>
                            <h2 class="subheading">A complete covert application that will allow users to access a port on a firewall and communicate with a &quot;disguised&quot; backdoor</h2>
                            <span class="meta">
                                Posted by
                                <a href="#!">Jason Soukchamroeun</a>
                                on September 28, 2021
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Post Content-->
        <article>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-10 mx-auto">
                        <h2 class="section-heading">Objective</h2>
                        <p>The main objective for this project was to make use of the standard TCP/IP header fields as  carriers of covert information. The methods described in <a href="https://firstmonday.org/ojs/index.php/fm/article/view/528/449" style="color: blue">Craig H. Rowland&#39s</a>  example has the  covert channel utilizing the IP layer&#39s identification field, a 16-bit field, capable of holding 2  ASCII characters per packet. In the document, Rowland mentions a couple viable options for  hiding data in covert channels which include the TCP initial sequence number field and the TCP  Acknowledge field.  </p>
                        <p>Rowland talks about the reliability of the data sent, as his code does not ACK the packets for  retries if there is any error. Another limitation to Rowland&#39s code is that it sleeps for a full  second between sending each byte of information.</p>
                        <p>The implementation that will be used for this project&#39s covert channel will use the source  port field while enabling the “E” (ECN &#8211 Explicit Congestion Notification) flag bit to denote that  the packet is a covert message. </p>

                        <h2 class="section-heading">Constraints</h2>
                        <ul>
                            <li>The technique for embedding covert data into the headers must be one that is not covered by any of the techniques in Rowlands paper.</li>
                            <li>Only use the TCP, UDP, or IP headers.</li>
                            <li>Show all the data supporting the success (or lack thereof) of the data embedding scheme.</li>
                            <li>Redesign the application using any programming language of choice.</li>
                        </ul>
                        <h2 class="section-heading">Approach</h2>
                        <p>The application consists of two components - the backdoor and the handler. The programs were written in python using the scapy library, a packet crafting API. </p>
                        <ul>
                            <li>The client.py &#8211 the covert message sender / the handler</li>
                            <li>The server.py &#8211 the covert message receiver / the backdoor</li>
                        </ul>
                        <p>The client program will forge packets where the “E” flag (ECN) is set to denote that the packet is a covert message. The message itself will be converted and stored into the source port. The E flag bit was chosen for flagging a covert message because it is rarely used in TCP/IP connections and it requires strict compliance on ECN processing two communicating machines.</p>
                        <p>The ports are redundant for this implementation since a three-way handshake is not being established. What&#39s expected is the server to respond back with an RST and ACK. The message will be converted to a decimal value and placed within client&#39s source port; the destination port will be set to be completely random.</p>
                        <img class="img-fluid" src="../assets/img/21-covert-channel/d1.png" alt="..." />
                        <img class="img-fluid" src="../assets/img/21-covert-channel/d2.png" alt="..." />
                        <span class="caption text-muted">overview of the backdoor communication process</span>
                        
                        <h2 class="section-heading">Testing</h2>
                        <p>Testing was accomplished by using tcpdump and Wireshark to capture traffic and verify  inbound packets were flagged with "E" bit and outbound packets were getting RST and ACK. </p>
                        <p>
                            <strong>Monitoring tool</strong>
                            : Wireshark and TCPdump
                            <br />
                            <strong>Results</strong>
                            :
                        </p>
                        <img class="img-fluid" src="../assets/img/21-covert-channel/d3.png" alt="..." />
                        <p>The  server IP will be stated within the script and a prompt will occur requesting a message to be sent.  Once the message is inputted, the program will craft packets with each byte of the message  converted to decimal number which will then be used as a source port for the packets. The  packets are flagged with "E" denoting it is a covert message.</p>
                        <img class="img-fluid" src="../assets/img/21-covert-channel/d4.png" alt="..." />
                        <p>The server is listening, receives and  confirms it is a covert message and re-converts the source port value back into human readable format and prints into the terminal.</p>
                        <img class="img-fluid" src="../assets/img/21-covert-channel/d5.png" alt="..." />
                        <p>We can confirm that each packet sent from the receiver is denoted with an "E" flag bit  with each byte of the message corresponding to a decimal used for the source port.  Additionally, the destination port for each packet sent is random. We can also confirm that the  server has received the packets as a RST,ACK packet is sent back to the convert sender.</p>
                        <div class="video-player">
                            <video src="../assets/videos/21-covert-channel/convertchannel.mp4"></video>
                            <div class="controls">
                                <button class="play-btn"><i class="fas fa-play"></i></button>
                                <button class="pause-btn"><i class="fas fa-pause"></i></button>
                                <button class="rewind-btn"><i class="fas fa-backward"></i></button>
                                <button class="fast-forward-btn"><i class="fas fa-forward"></i></button>
                                <div class="progress-bar">
                                <div class="progress"></div>
                                </div>
                                <button class="fullscreen-btn"><i class="fas fa-expand"></i></button>
                            </div>
                        </div>

                        <h2 class="section-heading">Conclusion</h2>
                        <p>The implementation I have presented improves on Rowland&#39s method by negating the “bounce” feature all together, but just like his implementation it still suffers from reliability. Future changes to rectify this reliability could include using another header field, such as the  type of service field, to denote the packet number and attempt a packet retransmission request  if the packets did not arrive in order. There are multiple fields and protocols, aside from the  ones Rowland mentioned, that can establish a covert channel, such as the ICMP type and code,  TCP source port, and UDP source port. Additionally, another way to increase reliability is to  include data redundancy and unique sequence numbers between packets. This would allow the  covert receiver to verify any missing data and derive that data from the following packets.</p>

                        <h2 class="section-heading">Source code</h2>
                        <p>
                            The project source code can be found
                            <a href="https://github.com/jvchamroeun/2021-btch-cc" style="color: blue">here</a>
                            .
                        </p>
                    </div>
                </div>
            </div>
        </article>
        <hr />
        <!-- Footer-->
        <my-footer></my-footer>
        <!-- Bootstrap core JS-->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="../js/scripts.js"></script>
        <script src="../js/custom-elements/video.js"></script>
    </body>
</html>
