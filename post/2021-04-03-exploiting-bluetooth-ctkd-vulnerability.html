<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Exploiting Bluetooth CTKD vulnerability</title>
        <link rel="icon" type="image/x-icon" href="assets/logo.png" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="../css/styles.css" rel="stylesheet" />
    </head>
    <body>
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
            <div class="container">
                <img src="../assets/logo.png" width="50" height="50" />
                <a class="navbar-brand" href="../index.html">Eric Wu</a>
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="../about.html">About</a></li>
                        <li class="nav-item"><a class="nav-link" href="../project.html">Projects</a></li>
                        <li class="nav-item"><a class="nav-link" href="../contact.html">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Page Header-->
        <header class="masthead" style="background-image: url('../assets/img/exploiting-bluetooth-ctkd-vulnerability/banner.jpg')">
            <div class="overlay"></div>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-10 mx-auto">
                        <div class="post-heading">
                            <h1>Exploiting Bluetooth CTKD vulnerability</h1>
                            <h2 class="subheading">The discovered Bluetooth vulnerability (CVE-2020-15802) makes it possible for attacker to steal Bluetooth session</h2>
                            <span class="meta">
                                Posted by
                                <a href="#!">Eric Wu</a>
                                on April 3, 2021
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Post Content-->
        <article>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-10 mx-auto">
                        <p>During my last semester at BCIT, in oder to get my CST bachelor degree, I had to come up with a software or poduct that the CST program committee would accept. Instead of developing a normal application, I chose a topic related to my program option (Network Security).</p>
                        <p>
                            While I was looking for ideas for my final project, I came across this
                            <a href="https://arxiv.org/abs/2009.11776" style="color: blue">paper</a>
                            . The paper is about how attacker can exploit an bluetooth vulnerability (assigned with CVE-2020-15902). The underlying principle behind the vulnerabitily is simple. I thought this could be an opportunity for me to learn something about bluetooth, so I decided to write a simple exploit base on this vulnerability.
                        </p>
                        <h2 class="section-heading">CTKD vulnerability</h2>
                        <p>In Bluetooth v4.2, a module called "Cross-Transport Key Derivation" (CTKD) was introduced. The module allow two bluetooth device pair once on either Bluetooth Classic (BT) or Bluetooth Low Energy (BLE).</p>
                        <p>The issue with the CTKD module is that it corsses the security boundaries between BT and BLE, which make the vulnerability exploitable for both transport. The paper goes into more detail on how this affects bluetooth security. Basically, the main problem is that pairing on one transport can overwrite the existing long term key generated from another transport.</p>
                        <p>Also, in bluetooth classic, the master and slave roles are not fixed. Attackers can take advantage of this role asymmetry to impersonate a slave device that is already trusted by a master device. After, it can send pairing requests to that master device. If the pairing request is accepted, the LKT generated by the acutal slave device will be overwritten</p>
                        <h2 class="section-heading">Steal Bluetooth session</h2>
                        <p>
                            After few weeks of research (mostly just googling and stackoverflow), I came up with a series of commands to target the weakness described previously. As shown in the following figure.
                            <img class="img-fluid" src="../assets/img/exploiting-bluetooth-ctkd-vulnerability/bluetooth-hijack-process.jpg" alt="..." />
                        </p>
                        <span class="caption text-muted">list of commands in the hijacking process</span>
                        <p>
                            One key factor in the success of the hijacking relies on the chosen association mechanism. An association mechanism is chosen base on the
                            <a href="https://www.bluetooth.com/blog/bluetooth-pairing-part-2-key-generation-methods/" style="color: blue">IO capability</a>
                            of both devices. Both initiator and responder will find an appropriate connecting method depending on their pairing features. If we set the IO capability to "NoInputNoOutput", the association mechanism "Just Work" will always be chosen. This mechanism requries little to no user interaction, which make the attack less suspectable to the user.
                        </p>
                        <p>CTKD does not enfore chosen association mechanism across bluetooth calssic and bluetooth low energy, which allows attackers to pair with a weak association mechanism such as Just Work. User is not going to notice an attacker that is repairing using Just Work pretending to be a trusted device.</p>
                        <h2 class="section-heading">Source code</h2>
                        <p>
                            The source code of the sample exploit can be found
                            <a href="https://github.com/ericwu1997/CTKD-bluetooth-exploit-sample" style="color: blue">here</a>
                            . I only tested the exploit on a Redmi smartphone and a samsung galaxy ear, and it worked. I ran the exploit on a kali linux machine, and have it established itself as a middle man between the two target device. However, to be honest, the exploit still needs alot more work to make it usable in common circumstance. Anyways, this small project just shows that bluetooth can be unsafe sometimes.
                        </p>
                        <img class="img-fluid" src="../assets/img/exploiting-bluetooth-ctkd-vulnerability/bluetooth-exploit-sample.jpg" alt="..." />
                        <span class="caption text-muted">screen capture of the exploit</span>
                    </div>
                </div>
            </div>
        </article>
        <hr />
        <!-- Footer-->
        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-md-10 mx-auto">
                        <ul class="list-inline text-center">
                            <li class="list-inline-item">
                                <a href="https://linkedin.com/in/ericwu1997">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li class="list-inline-item">
                                <a href="https://github.com/ericwu1997">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                        </ul>
                        <p class="copyright text-muted">Copyright &copy; Your Website 2021</p>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="../js/scripts.js"></script>
    </body>
</html>
